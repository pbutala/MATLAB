close all;
clearvars;
clc;
R = 50;
% YdBm = [-4.28 -3.4 -2.71 -1.61 -1.55 -1.9 -2.4 -2.97 -3.46 -3.94 -4.34 -4.78 -5.26 -5.52 -5.74 -6.06 -6.67 -7.73 -8.6 -8.8 -8.7 -8.5 -8.36 -8.26 -8.24 -8.2 -8.25 -8.4 -8.7 -9 -9.5 -10 -10.7 -12.8 -16.9 -18.7]; % V2 modification
% YdBm = [-7.42 -6.35 -5.65 -4.55 -4.5 -4.86 -5.4 -6 -6.5 -7.11 -7.67 -8.16 -8.6 -9 -9.47 -9.77 -10 -10.26 -10.5 -11 -11.6 -11.93 -12.1 -12.11 -12 -12 -11.86 -11.58 -11.25 -10.79 -10.66 -11 -16.35 -18.2]; % V3 modification
YdBm1 = [-5.12 -4.12 -3.55 -2.71 -2.78 -3.15 -3.77 -4.3 -4.76 -5.2 -5.6 -6.2 -6.88 -6.9 -7 -7.6 -9.46 -10.9 -10.45 -9.89 -9.7 -9.8 -9.64 -9.7 -10 -10.7 -11 -11.29 -11.3 -11.25 -11.86 -12.56 -13.9 -15.16 -16.3 -17.58 -18.85]; % V4 modification input 1V pp
YdBm2 = [-23.9 -23.18 -22.54 -21.31 -21.21 -21.55 -22.17 -22.65 -23 -23.58  -24 -24.49 -24.87 -25.21 -25.55 -25.82 -26.12 -26.37 -26.61 -26.8 -26.99 -27.2 -27.22 -27.25 -27.26 -27.24 -27.21 -27 -26.91 -26.7 -26.41 -25.87 -25.47 -24.96 -24.14 -22.78 -20.72 -21 -21.88 -23 -24.25 -25.51 -26.8 -28 -29.3 -30 -32.3 -33.77 -35.21 -36.45 -42.8 -48.8];% V4 modification input 0.1V pp
figure;

for i=1:2
    switch i
        case 1
            YdBm = YdBm1;
        case 2
            YdBm = YdBm2;
    end
    YdBV = YdBm - 10*log10(1000/R);
    
    Yrms = power(10,(YdBV/20));
    Ypk = Yrms*sqrt(2);
    X = 1;
    
    GAIN = Ypk/X;
    GAINdB = 20*log10(GAIN);
    plot(GAINdB-max(GAINdB));
    grid on;
    hold all;
end
plot([0 60],[-3 -3]);
legend('Input 1Vpp','Input 0.1Vpp','-3dB Marker','Location','SouthWest');
xlabel('Input signal frequency (MHz)');
ylabel('20log(Gain)');
title('Frequency response of MIMO transmitter board V4');